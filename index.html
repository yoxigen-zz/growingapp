<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>GrowingApp</title>
    <meta name="viewport" content="width=device-width">
    <link rel="icon" type="image/png" href="images/favicon.png"/>
    <link rel="stylesheet" type="text/css" href="style/main.css"/>
    <script src="phonegap.js"></script>
</head>
<body ng-controller="MainController" class="flex-horizontal" ng-class="{ offline: offline }" ng-style="{ visibility: appVisibility}">
    <div id="overlay" data-toggle-display="showMenu" ng-click="hideMenu()"></div>
    <div id="menu-wrapper" ng-class="{ render: !showFirstTimeSelection }" data-toggle-display="showMenu">
        <div id="menu">
            <header class="actionbar"><span class="app-name">GrowingApp</span></header>
            <ul id="players-menu">
                <li ng-repeat="listPlayer in players" class="flex-horizontal"
                    ng-class="{ selected: listPlayer.playerId === player.playerId, 'with-image': listPlayer.image.url }">
                    <a ng-click="setCurrentPlayer(listPlayer); hideMenu()" class="flex-1"><img class="player-image" ng-if="listPlayer.image.url" ng-src="{{listPlayer.image.url}}" />
                        {{::listPlayer.name}}
                    </a>
                    <a ng-click="editPlayer(listPlayer); hideMenu()" class="players-menu-edit">
                        <img class="child-menu-edit" src="images/icons/edit.svg"/>
                    </a>
                </li>
                <li class="players-menu-add">
                    <a class="button save-button" ng-click="addNewPlayer(); hideMenu()">
                        <img class="child-menu-add" src="images/icons/plus.svg"/>
                        Add Child
                    </a>
                </li>
            </ul>
            <ul>
                <li ng-repeat="item in ::menuItems" class="{{item.className}}" ng-class="{ selected: item.selected }" ng-show="!item.hide">
                    <a href="{{::item.href}}" ng-click="item.onClick($event)">
                            <span class="menu-icon">
                                <img ng-src="{{::item.icon}}"/>
                            </span>
                        <span class="menu-title">{{::item.text}}</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div class="flex-vertical flex-1">
        <header class="flex-horizontal actionbar" id="app-title" ng-class="{ 'pad-side': showFirstTimeSelection }">
            <a id="menu-button" class="actionbar-button" ng-click="toggleMenu()" ng-class="{ active: showMenu, render: !showFirstTimeSelection }">
                <img src="images/icons/menu-lines.svg" title="Menu"/>
            </a>
            <div class="flex-1">
                <span id="actionbar-name" ng-bind="player.name || 'GrowingApp'"></span>
            </div>
            <div class="hide-default" ng-class="{ visible: !showFirstTimeSelection }">
                <div id="spinner" toggle-display="showSpinner">
                    <img src="images/icons/spinner.svg" />
                </div>
                <a class="actionbar-button selectable" href="#/" ng-class="{ selected: currentPage == 'diary' }">
                    <img src="images/icons/list.svg" title="Diary" />
                </a>
                <a class="actionbar-button selectable" href="#/insights" ng-class="{ selected: currentPage == 'insights' }">
                    <img src="images/icons/charts-white.svg" title="Charts" />
                </a>
            </div>
        </header>
        <div id="contents-wrapper" class="flex flex-1">
            <div id="contents" class="flex-1 flex-vertical" ng-view></div>
        </div>
    </div>
    <slide-dialog show="dialogs.editPlayer.isOpen"
                  title="{{editedPlayer.playerId && 'Edit Child' || 'Add New Child'}}"
                  actions="editedPlayerActions"
                  on-show="onShowDialog($event)" on-hide="onHideDialog()">
        <div ng-include="'views/edit_player.html'"></div>
    </slide-dialog>
    <dialog show="dialogs.signIn.isOpen" title="{{::dialogs.signIn.title}}" on-show="onShowDialog($event)" on-hide="onHideDialog()" actions="signInActions" submit-action="signInSubmitAction">
        <div ng-include="::dialogs.signIn.htmlUrl"></div>
    </dialog>
    <slide-dialog show="dialogs.signUp.isOpen" title="{{::dialogs.signUp.title}}" on-show="onShowDialog($event)" on-hide="onHideDialog()">
        <div ng-include="::dialogs.signUp.htmlUrl"></div>
    </slide-dialog>
    <dialog show="dialogs.syncOffer.isOpen" title="{{::dialogs.syncOffer.title}}" on-show="onShowDialog($event)" on-hide="onHideDialog()" actions="syncOfferActions">
        <div ng-include="::dialogs.syncOffer.htmlUrl"></div>
    </dialog>
    <dialog show="dialogs.settings.isOpen"
                  title="{{::dialogs.settings.title}}"
                  icon="{{::dialogs.settings.icon}}"
                  on-show="onShowDialog($event)"
                  on-hide="onHideDialog()"
                  submit-action="settingsSubmitAction">
        <div ng-include="::dialogs.settings.htmlUrl"></div>
    </dialog>
    <slide-dialog show="insights.currentInsight"
                  title="{{insights.currentInsight.name}}"
                  on-show="onShowDialog($event)"
                  background="{{insights.currentInsight.entryType.color}}"
                  class="no-padding {{insights.currentInsight.className}}"
                  on-hide="onHideDialog()">
        <div ng-include="insights.currentInsight.templateUrl"></div>
    </slide-dialog>
    <ng-include src="'views/entry_templates.html'"></ng-include>
    <ng-include src="'views/entry_editors.html'"></ng-include>
    <script data-main="scripts/main.js" src="components/require.js"></script>
</body>
</html>