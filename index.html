<!DOCTYPE html>
<html ng-app="Diary">
<head lang="en">
    <meta charset="UTF-8">
    <title>Diary</title>
    <meta name="viewport" content="width=device-width">
    <link rel="icon" type="image/png" href="images/favicon.png" />
    <link rel="stylesheet" type="text/css" href="style/main.css" />
    <script src="components/parse-1.2.18.min.js"></script>
    <script src="components/angular.min.js"></script>
    <script src="components/angular-touch.min.js"></script>
    <script src="components/bindonce.min.js"></script>
    <script src="components/indexeddb.js"></script>

    <script src="scripts/directives/ng-tap.js"></script>
    <script src="scripts/directives/self-click.js"></script>
    <script src="scripts/directives/toggle-display.js"></script>
    <script src="scripts/services/eventbus.js"></script>
    <script src="scripts/services/utils.js"></script>

    <script src="scripts/app.js"></script>
    <script src="scripts/services/config.js"></script>
    <script src="scripts/services/classes/entry.js"></script>
    <script src="scripts/services/classes/player.js"></script>
    <script src="scripts/services/entries.js"></script>
    <script src="scripts/controllers/main_controller.js"></script>

    <script src="scripts/controllers/main_controller.js"></script>
    <script src="scripts/controllers/new_entry_controller.js"></script>
    <script src="scripts/controllers/entries_list_controller.js"></script>
</head>
<body ng-controller="MainController">
    <header id="actionbar" class="flex-horizontal">
        <div class="flex-1">
            <select class="fancy-select" ng-model="currentPlayer" ng-options="player.id as player.name for player in playersSelection"></select>
            <a ng-click="toggleEditPlayer()" ng-show="currentPlayer.id">
                <img src="images/icons/edit.svg" class="edit-button" title="Edit Child" />
            </a>
        </div>
        <a id="menu-button" ng-click="showMenu = !showMenu">
            <img src="images/icons/menu.svg" title="Menu" />
        </a>
    </header>
    <div id="contents-wrapper">
        <div id="contents" ng-controller="EntriesListController">
            <header class="contents-header flex-horizontal">
                <div>
                    <a id="newEntryButton" ng-click="toggleNewEntriesSelection()" class="button save-button" ng-class="{ active: showNewEntriesSelection }">
                        <img src="images/icons/plus.svg" /> New Entry
                    </a>
                </div>
                <div class="header-controls flex-1">
                    <select class="fancy-select"
                            ng-model="currentEntriesType"
                            ng-change="onEntriesTypeChange()"
                            ng-options="entryType.id as entryType.name for entryType in entryTypes">
                    </select>
                </div>
            </header>
            <div class="contents-scroll flex-1" ng-class="{ 'flex-vertical': entries && !entries.length }">
                <div id="contents-empty-message" class="flex-1" ng-cloak ng-show="entries && !entries.length">
                    <div>
                        <p>No {{currentEntriesType || ''}} entries added yet.</p>
                        <a class="button save-button" ng-click="toggleNewEntriesSelection()">Start adding</a>
                    </div>
                </div>
                <ul class="items-list">
                    <li ng-repeat="entry in entries">
                        <div class="items-list-item-content" ng-swipe-left="removeEntry(entry)" ng-class="{ removed: entry.removed }">
                            <img class="item-icon" ng-src="images/icons/{{entry.type.icon}}.svg" />
                            <div class="item-text">
                                <div ng-bind-html="entry.html"></div>
                                <div class="item-details" bindonce="entry" bo-bind="entry.dateText"></div>
                            </div>
                        </div>
                        <div class="items-list-item-removed">
                            Item removed <a class="button undo-button item-removed-undo" ng-click="undoRemoveEntry(entry)">Undo</a>
                        </div>
                    </li>
                </ul>
            </div>
            <div id="newEntryTypesWrapper"
                 class="entry-types-dialog-wrapper"
                 self-click="toggleNewEntriesSelection()"
                 ng-include="'views/new_entries_select.html'"
                 data-toggle-display="showNewEntriesSelection"
                 data-toggle-element="#newEntryType">
            </div>
        </div>
        <div id="tabs">
            <a href="#" class="selected">
                <span>Diary</span>
            </a>
            <a href="#">
                <span>Insights</span>
            </a>
        </div>
    </div>
    <div id="overlay" class="overlay"></div>
    <div id="menu-wrapper" data-toggle-display="showMenu">
        <div id="menu">
            <ul>
                <li>
                    <a href="#settings">
                        <span class="menu-icon">
                            <img src="images/icons/settings.svg" />
                        </span>
                        <span class="menu-title">Settings</span>
                    </a>
                </li>
                <li>
                    <a href="#share">
                        <span class="menu-icon">
                            <img src="images/icons/share.svg" />
                        </span>
                        <span class="menu-title">Add collaborators</span>
                    </a>
                </li>
                <li>
                    <a href="#contact">
                        <span class="menu-icon">
                            <img src="images/icons/mail.svg" />
                        </span>
                        <span class="menu-title">Report bug / Send feedback</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <span class="menu-icon">
                            <img src="images/icons/sign_out.svg" />
                        </span>
                        <span class="menu-title">Sign out yoxigen</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div id="playerEdit"
         class="popup-wrapper"
         ng-show="editedPlayer"
         data-toggle-display="showEditPlayer">
        <div class="popup">
            <header>
                <a class="close-button"
                   title="Close"
                   ng-click="showEditPlayer = false">
                    <img src="images/icons/close.svg" />
                </a>
                <span class="popup-title">{{editedPlayer.id && 'Edit Child' || 'Add New Child'}}</span>
            </header>
            <form>
                <div class="popup-contents">
                    <label>
                        <span class="label-text">Child Name</span>
                        <input type="text" ng-model="editedPlayer.name" required />
                    </label>
                    <div class="flex-horizontal">
                        <label class="flex-1">
                            <span class="label-text">Gender</span>
                            <select ng-model="editedPlayer.properties.gender" ng-options="gender.id as gender.label for gender in [{ id: 'f', label: 'Female'}, { id: 'm', label: 'Male' }]"></select>
                        </label>
                        <label class="flex-2">
                            <span class="label-text">Birthday</span>
                            <input type="date" ng-model="editedPlayer.properties.birthday" required />
                        </label>
                    </div>
                </div>
                <footer>
                    <a href="#" class="button save-button" ng-click="savePlayer()" style="width: 50%; float: right">
                        <img src="images/icons/ok.svg" />
                        Save Child
                    </a>
                    <a ng-click="showEditPlayer = false" class="button cancel-button" style="width: 48%">Cancel</a>
                </footer>
            </form>
        </div>
    </div>
    <ng-include src="'views/entry_editors.html'"></ng-include>
</body>
</html>