<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>GrowingApp</title>
    <meta name="viewport" content="width=device-width">
    <link rel="icon" type="image/png" href="images/favicon.png"/>
    <link rel="stylesheet" type="text/css" href="style/main.css"/>
    <script src="phonegap.js"></script>
</head>
<body ng-controller="MainController" class="flex-horizontal" ng-class="{ offline: offline }">
    <div id="splashscreen" ng-class="{ 'hide': appLoaded }" ng-if="!splashscreenKill">
        <div>
            <h1>GrowingApp</h1>
            <span class="spinner">
                <img src="images/icons/spinner.svg" />
            </span>
        </div>
    </div>
    <div id="overlay" data-toggle-display="dialogs.menu.isOpen" ng-click="dialogs.menu.close()"></div>
    <div id="menu-wrapper" ng-class="{ render: !showFirstTimeSelection }" data-toggle-display="dialogs.menu.isOpen">
        <div id="menu">
            <header class="actionbar"><span class="app-name">GrowingApp</span></header>
            <ul id="players-menu">
                <li ng-repeat="listPlayer in players" class="flex-horizontal"
                    ng-class="{ selected: listPlayer.playerId === player.playerId, 'with-image': listPlayer.image.url }">
                    <a ng-click="setCurrentPlayer(listPlayer); dialogs.menu.close()" class="flex-1"><img class="player-image" ng-if="listPlayer.image.url" ng-src="{{listPlayer.image.url}}" />
                        {{::listPlayer.name}}
                    </a>
                    <a ng-click="editPlayer(listPlayer); dialogs.menu.close()" class="players-menu-edit">
                        <img class="child-menu-edit" src="images/icons/edit.svg"/>
                    </a>
                </li>
                <li class="players-menu-add">
                    <a class="button save-button" ng-click="addNewPlayer(); dialogs.menu.close()">
                        <img class="child-menu-add" src="images/icons/plus.svg"/>
                        Add Child
                    </a>
                </li>
            </ul>
            <ul>
                <li ng-repeat="item in ::navigation.mainMenuItems" class="{{item.className}}" ng-class="{ selected: item.selected }" ng-show="!item.hide">
                    <a href="{{::item.href}}" ng-click="item.onClick($event)">
                            <span class="menu-icon">
                                <img ng-src="{{::item.icon}}"/>
                            </span>
                        <span class="menu-title">{{::item.text}}</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div class="flex-vertical flex-1">
        <header class="flex-horizontal actionbar"
                id="app-title"
                ng-show="!showFirstTimeSelection"
                ng-class="{ 'pad-side': showFirstTimeSelection }"
                ng-style="{ 'background-color': entries.currentEntriesType.color }">
            <a id="menu-button" class="actionbar-button" ng-click="toggleMenu()" ng-class="{ active: dialogs.menu.isOpen, render: !showFirstTimeSelection }">
                <img src="images/icons/menu-lines.svg" title="Menu"/>
            </a>
            <div class="flex-1" id="actionbar-main" ng-cloak>
                <dropdown close-on-click="true" button-text="{{player.name}}" button-class="player-name">
                    <ul class="dropdown-list">
                        <li ng-repeat="_player in players" ng-click="setCurrentPlayer(_player)" ng-class="{ selected: _player === player }">
                            <img class="list-icon player-list-icon" ng-style="{ 'background-image': _player.image.cssUrl }" />{{_player.name}}
                        </li>
                    </ul>
                    <ul class="dropdown-list">
                        <li ng-click="addNewPlayer()">
                            <div class="list-icon" style="background-image: url(images/icons/plus-black.svg)"></div>Add Child
                        </li>
                    </ul>
                </dropdown>
            </div>
            <div class="hide-default" ng-class="{ visible: !showFirstTimeSelection }">
                <div class="spinner" toggle-display="showSpinner">
                    <img src="images/icons/spinner.svg" />
                </div>
                <dropdown ng-if="currentPage === 'diary'"
                          button-class="{{!entries.currentEntriesType && 'disabled no-triangle'}}"
                          button-icon="{{entries.currentEntriesType && entries.currentEntriesType.icon.url || 'images/icons/filter.svg'}}"
                          close-on-click="true">
                    <ul class="dropdown-list">
                        <li ng-if="entries.currentEntriesType" ng-click="setEntriesType(null)">
                            <img src="images/icons/close-red.svg" class="list-icon" />Clear filter
                        </li>
                        <li ng-repeat="entryType in ::entryTypes" ng-class="{ selected: entryType === entries.currentEntriesType }" ng-click="setEntriesType(entryType)">
                            <div class="list-icon" ng-style="{ 'background-color': entryType.color, 'background-image': entryType.icon.cssUrl }"></div>{{entryType.name}}
                        </li>
                    </ul>
                </dropdown>
                <dropdown button-icon="{{navigation.currentPage.icon}}" close-on-click="true">
                    <ul class="dropdown-list">
                        <li ng-repeat="page in ::navigation.pages"
                            ng-class="{ selected: page === navigation.currentPage }"
                            ng-click="setEntriesType(null); navigation.setCurrentPage(page)"><img class="dropdown-list-icon" ng-src="{{page.listIcon}}" />{{page.name}}</li>
                    </ul>
                </dropdown>
            </div>
        </header>
        <div id="contents-wrapper" class="flex flex-1">
            <div id="contents" class="flex-1 flex-vertical" ng-view></div>
        </div>
    </div>
    <div ng-include="'views/global_dialogs.html'"></div>
    <ng-include src="'views/entry_templates.html'"></ng-include>
    <ng-include src="'views/entry_editors.html'"></ng-include>
    <script data-main="scripts/main.js" src="components/require.js"></script>
</body>
</html>